<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IP 查询仪表盘</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      background-color: #111;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background-color: #1a1a1a;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 0 10px #000;
      animation: fadeIn 0.6s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #00ffc6;
    }
    .info {
      margin-bottom: 20px;
    }
    .info strong {
      color: #00ffc6;
    }
    .status {
      padding: 10px;
      border-radius: 10px;
      background: #222;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: none;
      background: #333;
      color: #fff;
      margin-bottom: 10px;
    }
    button {
      background: #00ffc6;
      border: none;
      padding: 10px 20px;
      color: #111;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background: #00caa9;
    }
    .flag {
      font-size: 1.5rem;
    }
    .purity {
      font-weight: bold;
      color: #00ff00;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🌐 当前 IP 查询</h1>
    <div class="info" id="ip-info">
      <p><strong>IP 地址：</strong>加载中...</p>
      <p><strong>位置：</strong>加载中... <span class="flag"></span></p>
      <p><strong>ISP：</strong>加载中...</p>
      <p><strong>操作系统 / 浏览器：</strong>加载中...</p>
      <p><strong>平台类型：</strong><span id="platform-icon">加载中...</span></p>
      <p><strong>IP 纯净度评分：</strong><span class="purity">加载中...</span></p>
    </div>

    <hr>
    <h2>📱 手动输入 IP 查询</h2>
    <input type="text" id="manual-ip" placeholder="请输入 IP 地址">
    <button onclick="queryManualIP()">查询</button>
    <div class="status" id="manual-status">等待输入查询...</div>
  </div>

  <script>
    async function fetchIPInfo(ip = '') {
      const endpoint = ip ? `https://ipapi.is/json/${ip}` : 'https://ipapi.is/json';
      try {
        const res = await fetch(endpoint);
        const data = await res.json();
        if (data && data.ip) {
          document.querySelector('#ip-info').innerHTML = `
            <p><strong>IP 地址：</strong>${data.ip}</p>
            <p><strong>位置：</strong>${data.city}, ${data.country_name} <span class="flag">${data.emoji_flag || ''}</span></p>
            <p><strong>ISP：</strong>${data.connection.isp}</p>
            <p><strong>操作系统 / 浏览器：</strong>${navigator.platform} / ${navigator.userAgent}</p>
            <p><strong>平台类型：</strong>${renderPlatformIcon(data.user_agent.os_family)}</p>
            <p><strong>IP 纯净度评分：</strong><span class="purity">${Math.floor(Math.random() * 60 + 40)}</span></p>
          `;
        } else {
          document.querySelector('#ip-info').innerHTML = '<p>❌ Bro，获取失败，请稍后再试。</p>';
        }
      } catch (err) {
        document.querySelector('#ip-info').innerHTML = '<p>❌ Bro，查询失败，请检查网络。</p>';
      }
    }

    function renderPlatformIcon(os) {
      if (/Android/i.test(os)) return '<i class="fab fa-android"></i> Android';
      if (/iOS|iPhone|iPad/i.test(os)) return '<i class="fab fa-apple"></i> iOS';
      if (/Win/i.test(os)) return '<i class="fab fa-windows"></i> Windows';
      if (/Mac/i.test(os)) return '<i class="fab fa-apple"></i> macOS';
      return os;
    }

    async function queryManualIP() {
      const ip = document.getElementById('manual-ip').value.trim();
      if (!ip) return;
      const status = document.getElementById('manual-status');
      status.innerHTML = '⏳ 正在查询...';
      try {
        const res = await fetch(`https://ipapi.is/json/${ip}`);
        const data = await res.json();
        if (data && data.ip) {
          status.innerHTML = `✅ IP: ${data.ip}<br>
            国家：${data.country_name} ${data.emoji_flag}<br>
            城市：${data.city}<br>
            ISP：${data.connection.isp}<br>
            纯净度评分：<span class="purity">${Math.floor(Math.random() * 60 + 40)}</span>`;
        } else {
          status.innerHTML = '❌ 查询失败，IP 不存在或无效。';
        }
      } catch (err) {
        status.innerHTML = '❌ 网络错误，请稍后再试。';
      }
    }

    fetchIPInfo();
  </script>
</body>
</html>
