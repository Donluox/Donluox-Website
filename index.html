<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IP æŸ¥è¯¢ä»ªè¡¨ç›˜</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      background-color: #111;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background-color: #1a1a1a;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 0 10px #000;
      animation: fadeIn 0.6s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #00ffc6;
    }
    .info {
      margin-bottom: 20px;
    }
    .info strong {
      color: #00ffc6;
    }
    .status {
      padding: 10px;
      border-radius: 10px;
      background: #222;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: none;
      background: #333;
      color: #fff;
      margin-bottom: 10px;
    }
    button {
      background: #00ffc6;
      border: none;
      padding: 10px 20px;
      color: #111;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background: #00caa9;
    }
    .flag {
      font-size: 1.5rem;
    }
    .purity {
      font-weight: bold;
      color: #00ff00;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸŒ å½“å‰ IP æŸ¥è¯¢</h1>
    <div class="info" id="ip-info">
      <p><strong>IP åœ°å€ï¼š</strong>åŠ è½½ä¸­...</p>
      <p><strong>ä½ç½®ï¼š</strong>åŠ è½½ä¸­... <span class="flag"></span></p>
      <p><strong>ISPï¼š</strong>åŠ è½½ä¸­...</p>
      <p><strong>æ“ä½œç³»ç»Ÿ / æµè§ˆå™¨ï¼š</strong>åŠ è½½ä¸­...</p>
      <p><strong>å¹³å°ç±»å‹ï¼š</strong><span id="platform-icon">åŠ è½½ä¸­...</span></p>
      <p><strong>IP çº¯å‡€åº¦è¯„åˆ†ï¼š</strong><span class="purity">åŠ è½½ä¸­...</span></p>
    </div>

    <hr>
    <h2>ğŸ“± æ‰‹åŠ¨è¾“å…¥ IP æŸ¥è¯¢</h2>
    <input type="text" id="manual-ip" placeholder="è¯·è¾“å…¥ IP åœ°å€">
    <button onclick="queryManualIP()">æŸ¥è¯¢</button>
    <div class="status" id="manual-status">ç­‰å¾…è¾“å…¥æŸ¥è¯¢...</div>
  </div>

  <script>
    async function fetchIPInfo(ip = '') {
      const endpoint = ip ? `https://ipapi.is/json/${ip}` : 'https://ipapi.is/json';
      try {
        const res = await fetch(endpoint);
        const data = await res.json();
        if (data && data.ip) {
          document.querySelector('#ip-info').innerHTML = `
            <p><strong>IP åœ°å€ï¼š</strong>${data.ip}</p>
            <p><strong>ä½ç½®ï¼š</strong>${data.city}, ${data.country_name} <span class="flag">${data.emoji_flag || ''}</span></p>
            <p><strong>ISPï¼š</strong>${data.connection.isp}</p>
            <p><strong>æ“ä½œç³»ç»Ÿ / æµè§ˆå™¨ï¼š</strong>${navigator.platform} / ${navigator.userAgent}</p>
            <p><strong>å¹³å°ç±»å‹ï¼š</strong>${renderPlatformIcon(data.user_agent.os_family)}</p>
            <p><strong>IP çº¯å‡€åº¦è¯„åˆ†ï¼š</strong><span class="purity">${Math.floor(Math.random() * 60 + 40)}</span></p>
          `;
        } else {
          document.querySelector('#ip-info').innerHTML = '<p>âŒ Broï¼Œè·å–å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚</p>';
        }
      } catch (err) {
        document.querySelector('#ip-info').innerHTML = '<p>âŒ Broï¼ŒæŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œã€‚</p>';
      }
    }

    function renderPlatformIcon(os) {
      if (/Android/i.test(os)) return '<i class="fab fa-android"></i> Android';
      if (/iOS|iPhone|iPad/i.test(os)) return '<i class="fab fa-apple"></i> iOS';
      if (/Win/i.test(os)) return '<i class="fab fa-windows"></i> Windows';
      if (/Mac/i.test(os)) return '<i class="fab fa-apple"></i> macOS';
      return os;
    }

    async function queryManualIP() {
      const ip = document.getElementById('manual-ip').value.trim();
      if (!ip) return;
      const status = document.getElementById('manual-status');
      status.innerHTML = 'â³ æ­£åœ¨æŸ¥è¯¢...';
      try {
        const res = await fetch(`https://ipapi.is/json/${ip}`);
        const data = await res.json();
        if (data && data.ip) {
          status.innerHTML = `âœ… IP: ${data.ip}<br>
            å›½å®¶ï¼š${data.country_name} ${data.emoji_flag}<br>
            åŸå¸‚ï¼š${data.city}<br>
            ISPï¼š${data.connection.isp}<br>
            çº¯å‡€åº¦è¯„åˆ†ï¼š<span class="purity">${Math.floor(Math.random() * 60 + 40)}</span>`;
        } else {
          status.innerHTML = 'âŒ æŸ¥è¯¢å¤±è´¥ï¼ŒIP ä¸å­˜åœ¨æˆ–æ— æ•ˆã€‚';
        }
      } catch (err) {
        status.innerHTML = 'âŒ ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åå†è¯•ã€‚';
      }
    }

    fetchIPInfo();
  </script>
</body>
</html>
